{% extends 'parking/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Login" %} - Smart Parking{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'parking/css/login.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-box">
        <div class="login-header">
            <a href="{% url 'home' %}" class="brand">
                <img src="{% static 'parking/images/logo.png' %}" alt="Logo" class="login-logo">
                <h1>Smart Parking</h1>
            </a>
        </div>

        <div class="login-form">
            <h2>{% trans "Welcome Back" %}</h2>

            {% if messages %}
                {% for message in messages %}
                    <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                        <i class="fas fa-info-circle"></i> {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            <form method="post" class="form" autocomplete="off">
                {% csrf_token %}
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user"></i>
                        {% trans "Username" %}
                    </label>
                    <input type="text" id="username" name="username" required 
                           placeholder="{% trans 'Enter your username' %}"
                           autocomplete="off"
                           autocapitalize="none"
                           spellcheck="false">
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i>
                       Password
                    </label>
                    <div class="password-input">
                        <input type="password" id="password" name="password" required 
                               placeholder="{% trans 'Enter your password' %}"
                               autocomplete="new-password"
                               spellcheck="false"
                               data-form-type="password">
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>

                <div class="form-options">
                    <label class="remember-me">
                        <input type="checkbox" name="remember">
                        <span>{% trans "Remember me" %}</span>
                    </label>
                    <a href="#" class="forgot-password">{% trans "Forgot password?" %}</a>
                </div>

                <button type="submit" class="btn-login">
                    <i class="fas fa-sign-in-alt"></i>
                    {% trans "Login" %}
                </button>
            </form>

            <div class="login-footer">
                <p>{% trans "Don't have an account?" %}
                    <span class="register-link" style="color: #999; cursor: not-allowed;">
                        Liên hệ Admin để tạo tài khoản
                    </a>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Ngăn chặn trình duyệt tự động điền
    window.onload = function() {
        // Clear form khi tải trang
        const form = document.querySelector('form');
        if (form) form.reset();

        // Vô hiệu hóa autofill
        if (window.PasswordCredential) {
            navigator.credentials.preventSilentAccess();
        }
    };

    function togglePassword() {
        const passwordInput = document.getElementById('password');
        const toggleBtn = document.querySelector('.toggle-password i');

        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleBtn.classList.replace('fa-eye', 'fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            toggleBtn.classList.replace('fa-eye-slash', 'fa-eye');
        }
    }

    // Xóa giá trị khi focus vào input
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    if (usernameInput) usernameInput.addEventListener('focus', () => usernameInput.value = '');
    if (passwordInput) passwordInput.addEventListener('focus', () => passwordInput.value = '');
</script>
{% endblock %}
